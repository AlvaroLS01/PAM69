<html>
	#htmlhead("/secondary_screen/sales/payments/secondarypayments.css")
	<body class="background-card-pane">
		#environmentData('/secondary_screen/sales/payments/secondarypayments')
		<div class="payments-top"></div>
		<div class="payments-content">
			#set($payments = $basketTransaction.getPayments().getPaymentsList())
			#set($lessIncome = $basketTransaction.getPayments().getLessIncomePayments().values())
			#set($prepayments = $basketTransaction.getPayments().getPrepayments().getPaymentsList())
			#if($MathUtils.compare($basketTransaction.getTotals().getBalanceDue(), 0) == 0 && $MathUtils.compare($basketTransaction.getTotals().getChangeDue().getAmount(), 0) == 0)	
				<div class="czz-card bold">
					<div class="row label-total">
						<div class="col-4 fw-normal">#i18n("Total")</div>
						<div class="col-8 text-end">#balance($basketTransaction.getTotals().getTotalWithTaxes()) #monetarySimbol()</div>
					</div>
				</div>
			#else
				<div class="czz-card background-split-colors fw-bold">
					<div class="row label-total">
						<div class="col-4 fw-normal">#i18n("Total")</div>
						<div class="col-8 text-end">#balance($basketTransaction.getTotals().getTotalWithTaxes()) #monetarySimbol()</div>
					</div>
					#if($MathUtils.compare($basketTransaction.getTotals().getBalanceDue(), 0) > 0)
					<div class="row pending-area">
						<div class="fw-normal col">#i18n("Pendiente")</div>
						<div class="text-end label-pending col">#balance($basketTransaction.getTotals().getBalanceDue()) #monetarySimbol()</div>
					</div>
					#else
					<div class="row pending-area d-flex align-items-center">
						<div class="col">
							<div class="fw-normal big-text">#i18n("Cambio")</div>
							<div class="big-text">$basketTransaction.getTotals().getChangeDue().getChangePaymentMethod().getPaymentMethodDes()</div>
						</div>
						<div class="col-6">
							<div class="label-pending text-end">#balance($basketTransaction.getTotals().getChangeDue().getAmount()) #monetarySimbol()</div>
						</div>
					</div>
					#end
				</div>	
			#end
				
			#if($basketTransaction.getTotals().getTotalPayments() != 0)
			<div class="czz-card payments-actions">
				<div class="row header-area delivered-area bold">
					<div class="col-4">#i18n("ENTREGADO")</div>
					<div class="col-8 text-end">#balance($basketTransaction.getTotals().getTotalPayments()) #monetarySimbol()</div>
				</div>
				<div class="payments-details secondary-text">
					#foreach($payment in $payments)
					<div class="row">
						<div class="col">
							<div class="text-center icon-prepayment"></div>
						</div>
						<div class="col-5">${payment.getPaymentMethod().getPaymentMethodDes()}</div>
						<div class="col-5 text-end">#balance($payment.getAmount()) #monetarySimbol()</div>
					</div>
					#end
					#foreach($payment in $lessIncome)
					<div class="row">
						<div class="col">
							<div class="text-center icon-prepayment"><i class="icon-coupon"></i></div>
						</div>
						<div class="col-5">${payment.getPaymentMethod().getPaymentMethodDes()}</div>
						<div class="col-5 text-end">#balance($payment.getAmount()) #monetarySimbol()</div>
					</div>
					#end
					#foreach($payment in $prepayments)
					<div class="row">
						<div class="col">
							<div class="text-center icon-prepayment"><i class="icon-coupon"></i></div>
						</div>
						<div class="col-5">${payment.getPaymentMethod().getPaymentMethodDes()}</div>
						<div class="col-5 text-end">#balance($payment.getAmount())</div>
					</div>
					#end
				</div>
			</div>
			#end
			
			
			
			#set($textPromotions = [])
			#set($pointsPromotions = [])
			#foreach($promotion in $basketTransaction.getPromotions())
				#if($promotion.getPromotionTypeId() eq 13)
					#set($swallow = $textPromotions.add($promotion))
				#elseif($promotion.getPoints()>0)
					#set($swallow = $pointsPromotions.add($promotion))
				#end
			#end
			#if(!$textPromotions.isEmpty())
				<div class="czz-card">
					<div class="row header-area delivered-area bold">
						<div class="col">#i18n("MENSAJES PROMOCIONALES")</div>
					</div>
					<div>
						#foreach($promotion in $textPromotions)
							<div class="row secondary-text">
								<div class="col">
									<div class="text-center icon-prepayment"><i class="icon-promotion"></i></div>
								</div>
								<div class="col-10">${promotion.getPromotionText()}</div>
							</div>
						#end
					</div>
				</div>
			#end
			
			#if($basketTransaction.getTotals().getTotalSavingLessProfit() > 0)
			<div class="czz-card">
				<div class="row header-area delivered-area bold">
					<div class="col-6">#i18n("DESCUENTOS APLICADOS")</div>
					<div class="col-6 text-end">#balance($basketTransaction.getTotals().getTotalSavingLessProfit())</div>
				</div>
				<div>
					#foreach($promotion in $basketTransaction.getPromotions())
						#if($promotion.isLessProfitDiscount() && $promotion.getTotalSaving() > 0)
						<div class="row promotion-row secondary-text">
							<div class="col">
								<div class="text-center icon-prepayment"><i class="icon-promotion"></i></div>
							</div>
							<div class="col-6">${promotion.getPromotionText()}</div>
							<div class="col-2 text-end">${promotion.getPromotionId()}</div>
							<div class="col-2 text-end">#balance($promotion.getTotalSaving())</div>
						</div>
						#end
					#end
				</div>
			</div>
			#end
			
			#if($basketTransaction.getCardPromotionTransactions().size() > 0)
			<div class="czz-card">
				<div class="row header-area delivered-area bold">
					<div class="col-12">#i18n("SALDO A ACUMULAR")</div>
				</div>
				<div>
					#foreach($promotionTransaction in $basketTransaction.getCardPromotionTransactions())
					<div class="row secondary-text">
						<div class="col">
							<div class="text-center icon-prepayment"><i class="icon-coupon"></i></div>
						</div>
						<div class="col-4">$!{promotionTransaction.getConcept()}</div>
						<div class="col-4 text-end">$!{promotionTransaction.getCardCode()}</div>
						<div class="col-2 text-end">#if($promotionTransaction.getAmount()) #balance($promotionTransaction.getAmount()) #end</div>
					</div>
					#end
				</div>
			</div>
			#end
			
			#if($basketTransaction.getCouponsToIssue().size() > 0)
			<div class="czz-card">
				<div class="row header-area delivered-area bold">
					<div class="col-12">#i18n("CUPONES A EMITIR")</div>
				</div>
				<div>
					#foreach($coupon in $basketTransaction.getCouponsToIssue())
					<div class="row secondary-text">
						<div class="col">
							<div class="text-center icon-prepayment"><i class="icon-coupon"></i></div>
						</div>
						<div class="col-4">$!{coupon.getCouponName()}</div>
						<div class="col-4 text-end">${coupon.getPromotionId()}</div>
						<div class="col-2 text-end">#if($coupon.getBalance()) #balance($coupon.getBalance()) #end</div>
					</div>
					#end
				</div>
			</div>
			#end
		</div>
	</body> 
</html>